# Passwords in the Air: Harvesting Wi-Fi Credentials from SmartCfg Provisioning

> WiSec ’18
## [论文概述]
&emsp;&emsp;GoSSIP小组对一类智能家居上独有的安全问题——智能家居设备配网安全问题开展了深入的研究。所谓智能家居设备配网，是为智能家居设备（例如智能体重秤、智能空气净化器、智能洗衣机等）提供所接入Wi-Fi网络所需要的SSID和对应密码的过程。由于智能家居设备大多缺乏输入界面，使用者没有办法像使用计算机或者智能手机一样手工输入相关的信息，因此往往需要依赖于其他的一些途径（例如手机APP以及辅助的AP热点等）来向设备提供所需要的登陆凭据。我们的研究表明，这种在智能家居设备上独有的应用场景存在诸多安全问题。特别地，我们针对一类无线配网方案——SmartCfg配网方案开展的安全分析表明，当前市场上广泛使用的各类SmartCfg配网方案（来自于八家主流无线芯片商）中，多数方案均会导致Wi-Fi密码被攻击者解密获取，而针对市面上常见的超过60款智能家居设备的实际调查更是证实了这种危害的广泛存在：超过三分之二的设备确确实实受到此问题影响。
### SmartCfg配网技术具有三个典型的特征：
- 智能设备需要依赖App将Wi-Fi密码进行编码并通过广播发送给设备。
- 智能设备开启无线网卡的混杂模式被动监听数据，并且不知道发送者的身份。
- Wi-Fi密码被编码到一连串802.11数据包的元数据中（例如数据包的长度）
### SmartCfg安全分析
通过SDK静态代码分析+流量抓包分析  
#### 分析SmartCfg的安全性的困难性包括：
1. 如何识别智能设备中使用的SmartCf配网方案
2. 如何恢复配网协议中经过编码的Wi-Fi凭据
- 基于SDK代码的安全分析
- 单纯基于流量的分析
嗅探、定位前导码、差分分析
### 安全结果
分析了市面上八家主流无线芯片厂商所提供的SDK   
对市面上821款流行的智能家居应用，发现其中有64款应用使用SmartCfg技术，而在其中，42款应用存在上述分析中的安全隐患，
### 安全方案
![](https://raw.githubusercontent.com/ReAbout/IoT-Home/master/images/iot_air_1.jpg?token=AI5pPVuz6Xij6HEYQ6VLWGLgRxQ8GEXwks5cf44ZwA%3D%3D)

中文参考
https://zhuanlan.zhihu.com/p/35664962
